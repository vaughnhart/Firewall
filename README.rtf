{\rtf1\ansi\ansicpg1252\cocoartf2709
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fnil\fcharset0 HelveticaNeue-Bold;\f2\fswiss\fcharset0 Helvetica-Bold;
\f3\fnil\fcharset0 Menlo-Regular;\f4\fnil\fcharset0 HelveticaNeue;\f5\fswiss\fcharset0 ArialMT;
}
{\colortbl;\red255\green255\blue255;\red253\green139\blue9;\red41\green199\blue50;\red10\green96\blue255;
\red253\green130\blue8;\red0\green0\blue0;\red123\green123\blue129;\red144\green113\blue76;\red254\green195\blue9;
\red33\green255\blue255;\red157\green51\blue214;\red252\green33\blue37;\red0\green0\blue0;\red251\green0\blue7;
\red255\green246\blue0;\red255\green255\blue255;\red0\green0\blue0;\red248\green0\blue29;\red255\green255\blue255;
\red12\green67\blue255;\red104\green104\blue110;\red0\green0\blue0;\red252\green184\blue14;\red125\green94\blue59;
\red16\green60\blue192;\red255\green255\blue255;\red16\green61\blue193;}
{\*\expandedcolortbl;;\cssrgb\c100000\c61456\c0;\cssrgb\c15686\c80392\c25490\cname systemGreenColor;\cssrgb\c0\c47843\c100000\cname systemBlueColor;
\cssrgb\c100000\c58431\c0\cname systemOrangeColor;\cssrgb\c0\c0\c0\c84706\cname labelColor;\cssrgb\c55686\c55686\c57647\cname systemGrayColor;\cssrgb\c63529\c51765\c36863\cname systemBrownColor;\cssrgb\c100000\c80000\c0\cname systemYellowColor;
\cssrgb\c0\c100000\c100000;\cssrgb\c68627\c32157\c87059\cname systemPurpleColor;\cssrgb\c100000\c23137\c18824\cname systemRedColor;\cssrgb\c0\c1\c1;\cssrgb\c100000\c12195\c0;
\cspthree\c100000\c95881\c0;\cssrgb\c100000\c100000\c100000\c0;\csgray\c0;\cssrgb\c98824\c12941\c14510;\cssrgb\c100000\c100000\c100000;
\cssrgb\c3922\c37647\c100000;\cssrgb\c48235\c48235\c50588;\cssrgb\c0\c0\c0\c85098;\cssrgb\c99608\c76471\c3529;\cssrgb\c56471\c44314\c29804;
\cssrgb\c6667\c33333\c80000;\cssrgb\c100000\c100000\c99985;\cssrgb\c6979\c33703\c80362;}
\margl1440\margr1440\vieww27900\viewh16720\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 These firewall rules are based around Cisco Umbrella or OpenDNS Umbrella  Prosumer. \
{\field{\*\fldinst{HYPERLINK "https://www.opendns.com/home-internet-security/"}}{\fldrslt https://www.opendns.com/home-internet-security/}}\
{\field{\*\fldinst{HYPERLINK "https://docs.umbrella.com/deployment-umbrella/docs/2-prerequisites-update#section-network-access"}}{\fldrslt https://docs.umbrella.com/deployment-umbrella/docs/2-prerequisites-update#section-network-access}}\
You will need a license for Murus Pro\'85 which should bundle Vallum firewall as well.You\'92ll need them both.  \cf2 This is a restricted IPv4 only config.\
{\field{\*\fldinst{HYPERLINK "https://help.vallumfirewall.com/index.php?chapter=log"}}{\fldrslt https://help.vallumfirewall.com/index.php?chapter=log}} - Vallum Logging\cf0 \
\
Guidance\
{\field{\*\fldinst{HYPERLINK "https://github.com/drduh/macOS-Security-and-Privacy-Guide"}}{\fldrslt https://github.com/drduh/macOS-Security-and-Privacy-Guide}}\
{\field{\*\fldinst{HYPERLINK "https://github.com/usnistgov/macos_security#readme"}}{\fldrslt https://github.com/usnistgov/macos_security#readme}}\
{\field{\*\fldinst{HYPERLINK "https://tools.cisco.com/security/center/resources/dns_best_practices"}}{\fldrslt https://tools.cisco.com/security/center/resources/dns_best_practices}}\
{\field{\*\fldinst{HYPERLINK "https://www.cisco.com/c/en/us/support/docs/ip/access-lists/43920-iacl.html"}}{\fldrslt https://www.cisco.com/c/en/us/support/docs/ip/access-lists/43920-iacl.html}}\
{\field{\*\fldinst{HYPERLINK "https://csrc.nist.gov/"}}{\fldrslt https://csrc.nist.gov}}\
{\field{\*\fldinst{HYPERLINK "https://downloads.cisecurity.org/#/"}}{\fldrslt https://downloads.cisecurity.org/#/}}\
{\field{\*\fldinst{HYPERLINK "https://learn.microsoft.com/en-us/archive/blogs/secguide/"}}{\fldrslt https://learn.microsoft.com/en-us/archive/blogs/secguide/}}\
{\field{\*\fldinst{HYPERLINK "https://www.brightcloud.com/tools/url-ip-lookup.php"}}{\fldrslt https://www.brightcloud.com/tools/url-ip-lookup.php}}\
{\field{\*\fldinst{HYPERLINK "https://docs.umbrella.com/deployment-umbrella/docs/domain-management#section-3-internal-queries"}}{\fldrslt https://docs.umbrella.com/deployment-umbrella/docs/domain-management#section-3-internal-queries}}\
{\field{\*\fldinst{HYPERLINK "https://support.umbrella.com/hc/en-us/articles/115004651426-CNAME-Records-with-DNS-caching-and-Umbrella"}}{\fldrslt https://support.umbrella.com/hc/en-us/articles/115004651426-CNAME-Records-with-DNS-caching-and-Umbrella}}\
\
Lists:\
{\field{\*\fldinst{HYPERLINK "https://iplists.firehol.org/"}}{\fldrslt https://iplists.firehol.org}}\
{\field{\*\fldinst{HYPERLINK "https://firehol.org/guides/icmpv6-recommendations/#allow-incoming-destination-unreachable-messages-only-for-existing-sessions"}}{\fldrslt https://firehol.org/guides/icmpv6-recommendations/#allow-incoming-destination-unreachable-messages-only-for-existing-sessions}}\
{\field{\*\fldinst{HYPERLINK "https://www.spamhaus.org/"}}{\fldrslt https://www.spamhaus.org}}\
{\field{\*\fldinst{HYPERLINK "https://www.talosintelligence.com/"}}{\fldrslt https://www.talosintelligence.com}}\
{\field{\*\fldinst{HYPERLINK "https://secureupdates.checkpoint.com/IP-list/TOR.txt"}}{\fldrslt https://secureupdates.checkpoint.com/IP-list/TOR.txt}}\
{\field{\*\fldinst{HYPERLINK "https://www.opendbl.net/"}}{\fldrslt https://www.opendbl.net}}\
\
Changelog - 11/18/22\
\
Removed allow all apps outbound rule in Vallum  - apps need to be signed.\
Moved dhcp inbound rule higher in Vallum.\
\
Changelog - 12/04/22\
Removed duplicate lists (botscouts, myips, blocklist_de_strongips, blocklist_de_bots that were already covered in fireholl level2, level3, and abusers1d)\
Added my system configuration script\'85 not that it will name it to my current machine name. \
I also removed haley_ssh since there seems to be some update errors.  I also explicitly listed denies on the inbound side as per the NIST recommendations. \
\
Changelog - 12/11/22\
Added https://iplists.firehol.org/files/cruzit_web_attacks.ipset - CruzIT Web Attacks.\
Updated DYNDNS Pomcounp lists in Murus and added to Vallum.\
Added https://iplists.firehol.org/files/sslproxies_30d.ipset - SSL Proxies.\
\
]changelog - 1/15/23\
Removed VoIPBL list as it has errors on Firehouse site.\
Updated nations databases in Murus and Vallum\
Removed DYNDNS group from Murus rule\
Add these Ups to DYNDNS list in Vallum:\
3.130.204.160\
3.140.13.188\
18.119.154.66\
31.11.36.8\
63.247.141.235\
77.111.240.50\
\
Changelog 1/21/23\
Added {\field{\*\fldinst{HYPERLINK "https://media.defense.gov/2022/Jun/15/2003018261/-1/-1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF"}}{\fldrslt https://media.defense.gov/2022/Jun/15/2003018261/-1/-1/0/CTR_NSA_NETWORK_INFRASTRUCTURE_SECURITY_GUIDE_20220615.PDF}} as a reading resource .\
DNS restriction in Murus to manual rule\
Changed localnet oassthru to specified ports in Vallum. \
\pard\pardeftab720\partightenfactor0
\cf0 block in on egress proto tcp from any os unknown in Murus\
\
Chagnelog 1/22/23\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 antispoof log quick for eth0 inet\
\
Changellog 1/28/23 - script file changes ONLY\
sudo /bin/launchctl disable system/com.apple.netbiosd.plist\
sudo ifconfig en0 -arp\
#sudo ifconfig en0 dad - did not work\
\
changelog 1/29/23\
Aded https://iplists.firehol.org/files/bds_atif.ipset\
sudo launchctl disable system/netbiosd - in script\
\
changelog 1/31/23\
Added 8443 (tcp) to custom firewall rules in Murus and Vallum for testing.\
\
Changelog 2/1/23\
Added 192.16.58.8 for UmbrellaWhitelist in Murus and Vallum.\
Updates DYNDNS list in Vallum:\
31.11.36.8\
52.71.57.184\
52.86.6.113\
74.208.236.193\
77.111.240.50\
#######Murus rule change - all outbound rules are custom now. Please see Custom Rules picture in root folder for complete list. Example is below: \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b \cf3 pass \cf4 out\cf5  log \cf6 (user)\cf7  proto \cf8 \{\cf6 tcp, udp\cf8 \}\cf7  from \cf6 any\cf7  to \cf6 any\cf4  port \cf6  \cf8 \{\cf6 548, 88, 10548, 43, 3283, 5988, 5900, 631, 515, 9100, 123, 67, 68, 22, 8443, 80\cf8 \}\cf7  flags \cf6 S/SAFR\cf9  keep state\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0\b0 \cf0 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 Changelog 2/2/23\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 ########after seeing that Murus logs showed Safari making web browser connections to Umbrella (logging them as 208.67.x.x) instead of the web address I made some changes. Vallum flows monitor showed the correct addresses. \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 Vallum Inbound now limits Umbrella communication to OpenDNS signed apps and DHCP to all Apple signed apps\
Vallum Outbound now limits Umbrella communication to OpenDNS signed apps, DHCP to Apple signed apps, and all apps have to go through the filtered ports. \
Added DHCP in Murus options. Whatever the path is\'85 DHCP and ICMP have to be in that category\'85 and not the custom rules. \
\
Changelog 2/3/23\
Added a protection rule in Vallum for Vallum\'85 trying at least.\
############Murus Custom rules mostly mirrored in Valllum\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b \cf10 antispoof \cf5 log\cf11  quick \cf6 for eth0\cf4  inet\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf12 block \cf4 in\cf5  log\cf7 on \cf6 egress\cf7  proto \cf6 tcp\cf7  from \cf6 any os unknown\
\cf12 block \cf5 log\cf4  inet6\cf7  proto \cf6 ipv6-icmp\cf7  from \cf6 any\cf7  to \cf6 any\
\cf12 block \cf5 log\cf7  proto \cf6 icmp\cf7  from \cf6 any\cf7  to \cf6 any\
\cf12 block \cf5 log \cf6 (user)\cf7  proto \cf8 \{\cf6 tcp, udp\cf8 \}\cf7  from \cf6 any\cf7  to \cf6 any\cf4  port \cf6 0\
\cf12 block \cf5 log \cf6 (user)\cf7  proto \cf8 \{\cf6 tcp, udp\cf8 \}\cf7  from \cf6 any\cf7  to \cf6 any\cf4  port \cf6 3689\
\cf12 block \cf4 in\cf7  f\cf5 log \cf7 rom \cf6 any\cf7  to \cf6 255.255.255.255\
\cf12 block \cf4 in \cf5 log\cf7  from \cf6 any\cf7  to \cf6 127.0.0.1/32\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf3 pass \cf4 out\cf6  \cf5  log \cf6 (user)\cf7  from \cf6 any \cf7  to\cf4  <\cf6 WhiteUmbrella\cf4 >\cf7  flags \cf6 S/SAFR\cf9  keep state\
\cf3 pass \cf4 in\cf5  log \cf6 (user)\cf7  from\cf4  <\cf6 WhiteUmbrella\cf4 >\cf7  to \cf6 any\cf7  flags \cf6 S/SAFR\cf9  keep state\
\cf3 pass \cf7 proto \cf5 log\cf7  \cf6 igmp\cf9  allow-opts\
\cf3 pass \cf11 quick \cf5 log\cf7  from \cf6 any\cf7  to \cf8 \{\cf6 224.0.0.0/4 ff00::/8\cf8 \}\cf9  allow-opts\
\cf3 pass \cf7 proto \cf5 log\cf7  \cf8 \{\cf6 esp, gre\cf8 \}\cf7  from \cf6 any\cf7  to \cf6 any
\f0\b0 \cf0 \

\f1\b \cf3 pass \cf4 out\cf5  log \cf6 (user)\cf7  proto \cf8 \{\cf6 tcp\cf8 \}\cf7  from \cf6 any\cf7  to \cf6 any\cf4  port \cf8 \{\cf6 80, 443, 8443, 43\cf8 \}\cf7  flags \cf6 S/SAFR \cf9  keep state\
\cf3 pass \cf4 out\cf5  log \cf6 (user)\cf7  proto \cf8 \{\cf6 udp\cf8 \}\cf7  from \cf6 any\cf7  to \cf6 any\cf4  port \cf8 \{\cf6 123\cf8 \}\cf6  \cf9  keep state\
\cf3 pass \cf4 out\cf5  log \cf6 (user)\cf7  proto \cf8 \{\cf6 tcp\cf8 \}\cf7  from \cf6 any\cf7  to\cf4  <\cf6 all-local-nets\cf4 >\cf6  \cf4  port \cf6  \cf8 \{\cf6 22, 88, 389, 515, 548, 631, 636, 9100\cf8 \}\cf7  flags \cf6 S/SAFR\cf9  keep state\
\cf3 pass \cf4 out\cf5  log \cf6 (user)\cf7  proto \cf8 \{\cf6 tcp, udp\cf8 \}\cf7  from \cf6 any\cf7  to\cf4  <\cf6 all-local-nets\cf4 >\cf6  \cf4  port \cf6  \cf8 \{\cf6 53, 749, 3283, 5988, 5900\cf8 \}\cf7  flags \cf6 S/SAFR\cf9  keep state
\f0\b0 \cf0 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \
Changelog 2/6/23\
##########inbound rules.\
Block in log [tcp,udp] from any to any port 0\
\
Changelog 2/8/23\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f2\b \cf13 Added screenshots on the location to update the nations databases in Vallum and Murus\cf2 .\cf14  This is necessary for the Unknown Nation block. 
\f0\b0 \cf0 \
\
##################
\f3\fs22 \cf15 \CocoaLigature0 sudo tcpdump -i en0 -s0 -c 1100 -AeHnnttttvvv -w test.pcap\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 \CocoaLigature1 ##################
\f3\fs22 \cf15 \CocoaLigature0 Use Wireshark to see the data. Tcpdump is native on Mac/Linux. Wireshark is a GUI that makes it nice and readable. \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://www.tcpdump.org/manpages/tcpdump.1.html"}}{\fldrslt \cf15 https://www.tcpdump.org/manpages/tcpdump.1.html}} or {\field{\*\fldinst{HYPERLINK "https://www.tcpdump.org/index.html"}}{\fldrslt https://www.tcpdump.org/index.html}}\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://www.wireshark.org/"}}{\fldrslt \cf15 https://www.wireshark.org}}\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f2\b\fs24 \cf15 \
\pard\pardeftab720\partightenfactor0

\f0\b0 \cf13 \cb16 \expnd0\expndtw0\kerning0
\CocoaLigature1 For those with OpenDNS Cisco Umbrella Prosumer and legacy Cisco Umbrella packages... the Legacy Categories (under Content Categories) are still there. It might mean extra monitoring (using Activity Search)... or whitelisting (Global Allowed List under Destinations Lists)  but you can add those categories back. In this case more is more.\
\
Changelog 2/15/23\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b \cf12 \cb1 \kerning1\expnd0\expndtw0 block \cf5 log \cf7  proto \cf8 \{\cf6 tcp, udp\cf8 \}\cf7  from \cf6 any\cf4  port \cf8 \{\cf6 0, 5353\cf8 \}\cf7  to \cf6 any\cf4  port \cf8 \{\cf6 0, 5353\cf8 \}\cf6 \
Added Umbrella group back to PassList in Murus.\
\
Changelog 2/18/23\
Blocking and logging a \'93new\'94 signed version of com.apple.mDNSResponder in Vallum on the inbound and outbound.  While logging multicast traffic in Valllum.\
\
Changeling 2/21/23\
Another mdnsresponder was noticed in Flow Monitor\'85 blocked on inbound. \
\
Changeling 2/24/23 \
##################to block port 5353 ,make the following changes - in Murus and Vallum (inbound/outbound)\
remove the following rule\
 pass quick log from any to (224.0.0.0/4 ff00:/8) allow-opts\
add the following rules to the end of the custom rules\
 \cf12 block \cf5 log \cf6 (user)\cf7  proto \cf6 sscopmce\cf7  from \cf6 any\cf7  to \cf6 any\
\uc0\u65279 \u65279  block proto \{tcp, udp\} from any to any port \{5353\}\
Set custom rules tcp flags back to any in Murus. \
############# {\field{\*\fldinst{HYPERLINK "https://support.opendns.com/hc/en-us/articles/227988627-How-to-clear-the-DNS-Cache-"}}{\fldrslt https://support.opendns.com/hc/en-us/articles/227988627-How-to-clear-the-DNS-Cache-}} - You\'92ll need to do this after\
############# clear all browsing history (your web browsers) and system cache. {\field{\*\fldinst{HYPERLINK "https://www.tomsguide.com/how-to/how-to-clear-the-cache-on-mac"}}{\fldrslt https://www.tomsguide.com/how-to/how-to-clear-the-cache-on-mac}}\
############# clear all saved application states {\field{\*\fldinst{HYPERLINK "https://osxdaily.com/2011/07/17/delete-specific-application-saved-states-from-mac-os-x-10-7-lion-resume/"}}{\fldrslt https://osxdaily.com/2011/07/17/delete-specific-application-saved-states-from-mac-os-x-10-7-lion-resume/}}\
############# empty the trash and reboot
\f2 \cf13 \cb16 \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\b0 \cf0 \cb1 \
Changeling 3/3/23\
Added 3.19.116.195 to DYNDNS block list in Vallum \
\
Changeling 3/6/23\
There are new prerequisites for Cisco Umbrella\'85 updated them in Murus and Vallum. I didn\'92t remove anything\'85 just added 192.229.211.108\
{\field{\*\fldinst{HYPERLINK "https://docs.umbrella.com/deployment-umbrella/docs/2-prerequisites-update#section-network-access"}}{\fldrslt https://docs.umbrella.com/deployment-umbrella/docs/2-prerequisites-update#section-network-access}}\
There is an issue with resolving debug.opendns.com \
\
Changeling 3/7/23\
Added AdsYoyo blocklist from https://pgl.yoyo.org/adservers/iplist.php?ipformat=&showintro=0&mimetype=plaintext\
\
Changeling 4/3/23\
Added mask.icloud.com and mask-h2.icloud.com to Ban group in Vallum and also Global Block List in Cisco Umbrella. \
\
Changeling 4/4/23\
Added the following lines to the script file:\
cd /Users\
sudo chmod og-rwx *\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f1\b \cf6 #############
\f0\b0 \cf0  to run the script just copy to your Downloads folder and open terminal and go to that directory (cd ~/Downloads) and run the following command: sudo sh script \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f4 \cf6 ############# Mac OS will ask you to grant the  Terminal program permissions to your Downloads folder. \
\
Changelog 4/5/23\
added screenshots for the above changelog. The pictures are from OS Ventura 13.3 but are also applicable to OS Monterey. \
added the following recommendations from {\field{\*\fldinst{HYPERLINK "https://github.com/drduh/macOS-Security-and-Privacy-Guide"}}{\fldrslt https://github.com/drduh/macOS-Security-and-Privacy-Guide}} to the script:\
rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/exclusive\
rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/index.sqlite\
rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/index.sqlite-shm\
rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/index.sqlite-wal\
rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/resetreason\
rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/thumbnails.data\
sudo rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/thumbnails.fraghandler\
sudo rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/exclusive\
sudo rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/index.sqlite\
sudo rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/index.sqlite-shm\
sudo rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/index.sqlite-wal\
sudo rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/resetreason\
sudo rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/thumbnails.data\
sudo rm -rfv $(getconf DARWIN_USER_CACHE_DIR)/com.apple.QuickLook.thumbnailcache/thumbnails.fraghandler\
rm -rfv "~/Library/LanguageModeling/*" "~/Library/Spelling/*" "~/Library/Suggestions/*"\
chmod -R 000 ~/Library/LanguageModeling ~/Library/Spelling ~/Library/Suggestions\
chflags -R uchg ~/Library/LanguageModeling ~/Library/Spelling ~/Library/Suggestions\
rm -rfv "~/Library/Application Support/Quick Look/*"\
chmod -R 000 "~/Library/Application Support/Quick Look"\
chflags -R uchg "~/Library/Application Support/Quick Look"\
sudo rm -rfv /.DocumentRevisions-V100/*\
sudo chmod -R 000 /.DocumentRevisions-V100\
sudo chflags -R uchg /.DocumentRevisions-V100\
rm -rfv "~/Library/Saved Application State/*"\
rm -rfv "~/Library/Containers/<APPNAME>/Saved Application State"\
chmod -R 000 "~/Library/Saved Application State/"\
chmod -R 000 "~/Library/Containers/<APPNAME>/Saved Application State"\
chflags -R uchg "~/Library/Saved Application State/"\
chflags -R uchg "~/Library/Containers/<APPNAME>/Saved Application State"\
rm -rfv "~/Library/Containers/<APP>/Data/Library/Autosave Information"\
rm -rfv "~/Library/Autosave Information"\
chmod -R 000 "~/Library/Containers/<APP>/Data/Library/Autosave Information"\
chmod -R 000 "~/Library/Autosave Information"\
chflags -R uchg "~/Library/Containers/<APP>/Data/Library/Autosave Information"\
chflags -R uchg "~/Library/Autosave Information"\
rm -rfv ~/Library/Assistant/SiriAnalytics.db\
chmod -R 000 ~/Library/Assistant/SiriAnalytics.db\
chflags -R uchg ~/Library/Assistant/SiriAnalytics.db\
defaults delete ~/Library/Preferences/com.apple.iTunes.plist recentSearches\
sudo shutdown -r now -o\
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0

\f0 \cf0 changelog 4/10/23\
added LPI certification reading material\'85 if you want to learn Linux and command line\
added a photo from my machine while at the Apple Store\'85 showing that Apple blocks mask-h2.icloid.com on their Apple Store network using Cisco Umbrella. You have to use the Cisco Umbrella test page {\field{\*\fldinst{HYPERLINK "https://welcome.opendns.com/"}}{\fldrslt https://welcome.opendns.com}} (not www.internetbadguys.com which redirects to the Apple web site) to see that their network is protected by Cisco Umbrella. This stance is quire different from their advertising that Apple is \'93safe\'94. Contrast that with the photo I posted showing I can\'92t block mask and mask-h2 on my Cisco Umbrella.  I had to use the dig command instead of nslookup (which returned no values)\'85 leading me to believe Apple doesn\'92t advertise their use of Cisco Umbrella. Use any of their store machines and verify what I\'92m saying. \
\
changelog  4/15/23\
###############blocking some non-routeable (martian) traffic\'85 that shouldn\'92t affect anything. But some people have seen internet routing on these addresses. \
added to Ban in Vallum 127.0.0.0/8, 0.0.0.0/8, 192.0.2.0/24, 240.0.0.0/4 \
created a new Murus rule: Murus_UmbrellaDNSOnly that stops all other non-CIsco Umbrellal DNS lookup. This does play well with others. It supposed to stop DNS leak and in the process las no local or other DNS resolution. You home network devices will be harder to find. It might be better for coffee shops/networks you don\'92t manage. Plus Google\'85 and some other ISPs/network admins have their own DNS bypass/leaks that sometimes circumvent Umbrella. This is meant to stop that. Youtube may not like that it can\'92t lookup its own servers anymore\'85. just refresh the page. \
\
changelog 4/16/23\
created a new Vallum rule: Vallum_UmbrellaDNSOnly  that reflects the DNS leak changes.\
##################  mask-api.icloud.com which seems to have a lot of traffic generated to it as well in Cisco Umbrella but NIST hasn\'92t added it to their recommended block list. You may want to as well. Apple\'92s mask*.icloud.com address seem to be categorized under Online Storage but are actually proxy/anonymizer or DoH and DoT. Sorta like nesting a domain name. site.example.com hosts the vpn, but example.com is for art.\
\
changelog 4/17/23\
added in Murus and Murus_UmbrellaDNSOnly:\
an inbound and an outbound rule blocking all ports on ipv6\
block quick log from any to \{224.0.0.0/4 ff00::/8 224.0.0.251/32 ff02::fb/128\}\
block log (user) proto 53 from any to any\
block log (user) inet6 from any to any\
added mask-api.icloud.com to Ban list in Vallum and Vallum_UmbrellaDNSOnly.\
\
added in Vallum and Vallum_UmbrellaDNSOnly:\
block in ipv6 from any to any by all apps (any protocol version ipv6)\
block in ipv6 from any to any by all apps (ipv6 protocol version any)\
block out ipv6 from any to any by all apps (any protocol version ipv6)\
block out  ipv6 from any to any by all apps (ipv6 protocol version any)\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf17 added 224.0.0.251/32 and ff02::fb/128 to MDNS group.\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 ################## I\'92m \cf17 trying to kill MDNS and ICMP-V6 packets in packet captures (without edge or switch control)\'85 iCloud/AirPlay might automate these broadcasts. fixed an error.\
\
changelog 4/18/23\
removed esp and gre from 
\f2\b all
\f0\b0  profiles  as per the recommendation of Cisco Umbrella. If you\'92re using a VPN this might break it.\
added to all Murus profiles:\
\pard\pardeftab720\partightenfactor0

\f1\b\fs26 \cf18 \cb19 \expnd0\expndtw0\kerning0
block \cf20 in inet6\cf21  proto \cf22 ipv6-icmp all\cf21  \cf23 icmp6-type\cf21  \cf24 \{\cf22 135\cf24 \}\
\cf18 block \cf20 in inet6\cf21  proto \cf22 ipv6-icmp all
\f0\b0\fs24 \cf0 \cb1 \kerning1\expnd0\expndtw0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 ##################  I\'92m hunting wabbits with the above rules\'85 this is me trying to secure wifi with a configuration that should probably be in sysclt or a kext or a kernel config for tcp/ip. Above my scope of experience and knowledge.\
\
changelog 4/21/23\
Vallum and VallumUmbrellaDNSOnly: fixed a dhcp error\'85 I think. Captive Portal may not work with UmbrellaDNSOnly configuration. \
\
changelog 4/25/23\
added a rule in Vallum_UmbrellaDNSOnly allowing captive portal assistant to connect to port 53 of UDP (DNS) for DHCP connections.\
added a rule in Murus_UmbrellaDNSOnly allowing all-local-nets to connect to DNS (UDP 53) only on all-local-nets for that Captive Portal can make the connections. \
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural\partightenfactor0
\cf0 changelog 4/26/23\
changed the rule in Murus_UmbrellaDNSOnly allowing all-local-nets to connect to any DNS (UDP 53) for Captive Portal connections.\
\
changelog 4/27/23\
fixed DHCP issues in Vallum and Vallum_UmbrellaDNSOnly. Working on Captive Portal Issues. \
added new Vallum config called Test_UmbrellaPort53 which adds UDP 53 access to Umbrella apps in addition to CaptivePortal. \
\
Changeling 5/623\
Added screenshots for Privacy and Security Settings and Battery Configuration (OS Ventura\'85 but the options exist in previous Mac OSs - check Energy Saver )\
Added additional US Government recommendation on logging. (This is for really advanced users)\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0
\cf0 \
Zelle me:  vaughn@aegisitnyc.com\
\
\pard\pardeftab720\partightenfactor0
{\field{\*\fldinst{HYPERLINK "https://www.linkedin.com/in/vahart"}}{\fldrslt 
\f5\fs26 \cf25 \cb19 \expnd0\expndtw0\kerning0
\ul \ulc25 https://www.linkedin.com/in/vahart}}
\f5\fs26 \cf25 \cb19 \expnd0\expndtw0\kerning0
\ul \ulc25 \
\
\pard\pardeftab720\partightenfactor0
\cf13 \cb26 \ulc27 command  line quicksheet\
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f3\fs22 \cf15 \cb1 \kerning1\expnd0\expndtw0 \ulnone \CocoaLigature0 sudo tcpdump -i en0 -s0 -c 1100 -AeHnnttttvvv -w test.pcap\
sudo lsof -i -n -P \
netstat -arn\
arp -an\
who -a}